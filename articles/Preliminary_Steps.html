<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="devMSMs">
<title>Preliminary Steps • devMSMs</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Preliminary Steps">
<meta property="og:description" content="devMSMs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">devMSMs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Data_Requirements.html">Data Requirements</a>
    <a class="dropdown-item" href="../articles/Preliminary_Steps.html">Preliminary Steps</a>
    <a class="dropdown-item" href="../articles/Specify_Core_Inputs.html">Specify Core Inputs</a>
    <a class="dropdown-item" href="../articles/Terminology.html">Terminology</a>
    <a class="dropdown-item" href="../articles/Workflow_Continuous_Exposure.html">Workflow: Continuous Exposure</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/istallworthy/devMSMs/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Preliminary Steps</h1>
                        <h4 data-toc-skip class="author">Isabella
Stallworthy</h4>
            
            <h4 data-toc-skip class="date">2023-11-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/istallworthy/devMSMs/blob/HEAD/vignettes/Preliminary_Steps.Rmd" class="external-link"><code>vignettes/Preliminary_Steps.Rmd</code></a></small>
      <div class="d-none name"><code>Preliminary_Steps.Rmd</code></div>
    </div>

    
    
<p><br></p>
<p>These four recommended preliminary steps are designed to assist the
user in preparing and inspecting their data to ensure appropriate use of
the package. Users should first view the
<a href="https://istallworthy.github.io/devMSMs/articles/Terminology.html">Terminology</a>
vignette and complete the Data Requirements and
<a href="https://istallworthy.github.io/devMSMs/articles/Specify_Core_Inputs.html">Specifying
Core Inputs</a> vignettes. The following recommended preliminary steps
(using helper functions summarized in Table 1 are not included in the
<em>devMSMs</em> package that can be found at the following
<a href="https://github.com/istallworthy/devMSMsHelpers" class="external-link">Github</a> are
designed to assist the user in preparing and inspecting their data and
guide specification of required function inputs to ensure appropriate
use of the package. Of note, <em>devMSMs</em> must also be installed and
loaded to use these helper functions (see
<a href="https://istallworthy.github.io/devMSMs/">Installation</a>).</p>
<p>The user who has already formatted their data in wide format
according to the Data Requirements vignette and imputed to accommodate
any missing data (P2), can focus only on subsections P3 Identifying
Optional Exposure Epochs and P4 Verifying History Distributions prior to
using the package. Following completion of this vignette, users should
use one of the Workflows vignettes to implement <em>devMSMs</em> with
their longitudinal data.</p>
<p><em>insert Table 1 here</em>.</p>
<p><br></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Installing package into '/home/runner/work/_temp/Library'</span></span>
<span><span class="co">#&gt; (as 'lib' is unspecified)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"stats"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Installing package into '/home/runner/work/_temp/Library'</span></span>
<span><span class="co">#&gt; (as 'lib' is unspecified)</span></span>
<span><span class="co">#&gt; Warning: package 'stats' is a base package, and should not be updated</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"missMethods"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Installing package into '/home/runner/work/_temp/Library'</span></span>
<span><span class="co">#&gt; (as 'lib' is unspecified)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: usethis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/torockel/missMethods" class="external-link">missMethods</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"istallworthy/devMSMs"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://istallworthy.github.io/devMSMs/">devMSMs</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"istallworthy/devMSMsHelpers"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">devMSMsHelpers</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p>Choose from the following preliminary steps with the goal of
assigning to ‘data’ one of the following for use in the package: - a
single data frame of data in wide format with no missing data - a mids
object (output from mice::mice()) of data imputed in wide format - a
list of data imputed in wide format as data frames.</p>
<p>Data columns should be either numeric or factor form and the ID
column should be numeric.</p>
<p>Some helper functions have optional arguments to suppress saving
output locally (<code>save.out = FALSE</code>) and printing it to the
console ( <code>verbose = FALSE</code>). The defaults to both arguments
are TRUE. Users must supply a path to a home directory if
<code>save.out = TRUE</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">save.out</span> <span class="op">=</span> <span class="cn">FALSE</span></span>
<span></span>
<span><span class="va">verbose</span> <span class="op">=</span> <span class="cn">TRUE</span></span></code></pre></div>
<p><br></p>
<div class="section level3">
<h3 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data &lt;- read.csv('/Users/isabella/Library/CloudStorage/Box-Box/BSL General/MSMs/testing/testing data/continuous outcome/continuous exposure/FLP_wide_imputed.csv')</span></span>
<span></span>
<span><span class="co">#temporary data until we get sim data</span></span>
<span><span class="va">wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>S_ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span>,</span>
<span>                   ESETA1.6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>                   ESETA1.15 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>                   ESETA1.24 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>                   peri_health <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>                   gov_assist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>                   InRatioCor.6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>                   InRatioCor.15 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>                   InRatioCor.24 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>                   WndNbrhood.6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>                   WndNbrhood.15 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>                   WndNbrhood.24 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>                   StrDif_Tot.58 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_long</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">wide</span>,</span>
<span>                            idvar <span class="op">=</span> <span class="st">"S_ID"</span>, <span class="co">#'list ID variable</span></span>
<span>                            varying <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ESETA1.6"</span>, <span class="st">"ESETA1.15"</span>, <span class="st">"ESETA1.24"</span>,</span>
<span>                                        <span class="st">"InRatioCor.6"</span>, <span class="st">"InRatioCor.15"</span>, <span class="st">"InRatioCor.24"</span>,</span>
<span>                                        <span class="st">"WndNbrhood.6"</span>, <span class="st">"WndNbrhood.15"</span>, <span class="st">"WndNbrhood.24"</span><span class="op">)</span>,</span>
<span>                            direction <span class="op">=</span> <span class="st">"long"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_long_missing</span> <span class="op">&lt;-</span> <span class="fu">missMethods</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/missMethods/man/delete_MAR_1_to_x.html" class="external-link">delete_MAR_1_to_x</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">data_long</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                                                    cols_mis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ESETA1"</span>,</span>
<span>                                                                 <span class="st">"WndNbrhood"</span><span class="op">)</span>,</span>
<span>                                                    cols_ctrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"InRatioCor"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="core-inputs">Core inputs<a class="anchor" aria-label="anchor" href="#core-inputs"></a>
</h3>
<p>Please see the Specifying Core Inputs vignette for more detail on the
following core inputs.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#set seed for reproducibility </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#required if you wish to use save.out = TRUE in the functions</span></span>
<span><span class="va">home_dir</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="co"># home_dir &lt;- '/Users/isabella/Library/CloudStorage/Box-Box/BSL General/MSMs/testing/isa' #note: no / after</span></span>
<span></span>
<span><span class="co">#required</span></span>
<span><span class="va">exposure</span> <span class="op">&lt;-</span> <span class="st">"ESETA1"</span></span>
<span></span>
<span><span class="co">#required</span></span>
<span><span class="va">exposure_time_pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">15</span>, <span class="fl">24</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#required</span></span>
<span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="st">"StrDif_Tot.58"</span></span>
<span></span>
<span><span class="co">#required; list in wide format</span></span>
<span><span class="va">tv_confounders</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>                    <span class="co"># "SAAmylase.6","SAAmylase.15", "SAAmylase.24",</span></span>
<span>                    <span class="co"># "MDI.6", "MDI.15",                                            </span></span>
<span>                    <span class="co"># "RHasSO.6", "RHasSO.15", "RHasSO.24","RHasSO.35", "RHasSO.58",                                         </span></span>
<span>                    <span class="st">"WndNbrhood.6"</span>,<span class="st">"WndNbrhood.15"</span>, <span class="st">"WndNbrhood.24"</span>, <span class="co">#"WndNbrhood.35", "WndNbrhood.58",                                       </span></span>
<span>                    <span class="co"># "IBRAttn.6", "IBRAttn.15", "IBRAttn.24",                                   </span></span>
<span>                    <span class="co"># "B18Raw.6", "B18Raw.15", "B18Raw.24", "B18Raw.58",                                           </span></span>
<span>                    <span class="co"># "HOMEETA1.6", "HOMEETA1.15", "HOMEETA1.24", "HOMEETA1.35", "HOMEETA1.58",                               </span></span>
<span>                    <span class="st">"InRatioCor.6"</span>, <span class="st">"InRatioCor.15"</span>, <span class="st">"InRatioCor.24"</span>, <span class="co">#"InRatioCor.35", "InRatioCor.58",                         </span></span>
<span>                    <span class="st">"ESETA1.6"</span>, <span class="st">"ESETA1.15"</span>, <span class="st">"ESETA1.24"</span><span class="co"># "ESETA1.35", "ESETA1.58",  #exposure variables required               </span></span>
<span>                    <span class="co"># "CORTB.6", "CORTB.15", "CORTB.24",                                                                  </span></span>
<span>                    <span class="co"># "EARS_TJo.24", "EARS_TJo.35",                                        </span></span>
<span>                    <span class="co"># "LESMnPos.24", "LESMnPos.35",                                  </span></span>
<span>                    <span class="co"># "LESMnNeg.24", "LESMnNeg.35",       </span></span>
<span>                    <span class="co"># "StrDif_Tot.35", </span></span>
<span>                    <span class="co"># "StrDif_Tot.58"    </span></span>
<span>                    <span class="co"># "fscore.35", "fscore.58"</span></span>
<span>                    <span class="co"># , "ESETA1.6:B18Raw.6", "ESETA1.6:B18Raw.15:RHasSO.6", "state:EARS_TJo.35" #testing interactions</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="co">#required</span></span>
<span><span class="va">ti_confounders</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>                    <span class="co"># "state", "BioDadInHH2", "PmAge2", "PmBlac2", "TcBlac2", "PmMrSt2", "PmEd2", "KFASTScr",</span></span>
<span>                    <span class="co"># "RMomAgeU", "RHealth", "HomeOwnd", "SWghtLB", "SurpPreg", "SmokTotl", "DrnkFreq",</span></span>
<span>                    <span class="st">"peri_health"</span>, </span>
<span>                    <span class="co"># "caregiv_health", </span></span>
<span>                    <span class="st">"gov_assist"</span></span>
<span>                    <span class="co">#, "state:SmokTotl", "PmAge2:PmBlac2", "PmAge2:PmEd2" #testing interaction terms</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="p1--format-data">P1. Format Data<a class="anchor" aria-label="anchor" href="#p1--format-data"></a>
</h3>
<p>All data must be wide format and contain an “ID” column for subject
identifier and exposure, outcome, and all confounders as separate
columns (as shown in Figure 1). Column names can include only underscore
special characters and time-varying variables should have a suffix that
consists of a period followed by the time point (e.g., “variable.6”).
All variables should be classed as integer, numeric, or a factor (not
character). Auxiliary or nuisance covariates that are not confounders
(e.g, assessment version) can be included in the dataset for use and
specification in the final modeling step (<em>Workflow</em> vignettes
Step 5).<br><br></p>
<p><em>insert Figure 1 here</em>.</p>
<p><br></p>
<div class="section level4">
<h4 id="p1a--format-single-data-frame-of-long-data">P1a. Format single data frame of long data<a class="anchor" aria-label="anchor" href="#p1a--format-single-data-frame-of-long-data"></a>
</h4>
<p>Users beginning with a single data frame in long format (with or
without missingness) can utilize a helper function
<code><a href="https://rdrr.io/pkg/devMSMsHelpers/man/formatLongData.html" class="external-link">formatLongData()</a></code> to summarize exposure and outcome data and
convert to required variable names. This function takes a dataset in
long format and any variables for time (time_var), ID (id_var), and
missing data (missing) with alternative variables and re-labels them
according to what is required by the package. It also classes any factor
confounders (factor_confounders) as factors in the data and all others
as numeric.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_long_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/devMSMsHelpers/man/formatLongData.html" class="external-link">formatLongData</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_long_missing</span>, exposure <span class="op">=</span> <span class="va">exposure</span>, </span>
<span>                              exposure_time_pts <span class="op">=</span> <span class="va">exposure_time_pts</span>, outcome <span class="op">=</span> <span class="va">outcome</span>, </span>
<span>                              time_var <span class="op">=</span> <span class="st">"time"</span>, id_var <span class="op">=</span> <span class="st">"S_ID"</span>,                                </span>
<span>                              missing <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                              factor_confounders <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                              home_dir <span class="op">=</span> <span class="va">home_dir</span>, </span>
<span>                              save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Table: Summary of ESETA1 Exposure Information</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; | WAVE|       mean|        sd|       min|      max|</span></span>
<span><span class="co">#&gt; |----:|----------:|---------:|---------:|--------:|</span></span>
<span><span class="co">#&gt; |    6|  0.0378583| 0.8805963| -1.708582| 2.370463|</span></span>
<span><span class="co">#&gt; |   15| -0.1689015| 0.9042307| -2.099902| 1.601213|</span></span>
<span><span class="co">#&gt; |   24| -0.0793099| 1.0295984| -1.906230| 2.328068|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Summary of Outcome StrDif_Tot.58 Information</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; | WAVE|      mean|       sd|       min|      max|</span></span>
<span><span class="co">#&gt; |----:|---------:|--------:|---------:|--------:|</span></span>
<span><span class="co">#&gt; |    6| 0.0985709| 1.113742| -1.741084| 2.442707|</span></span>
<span><span class="co">#&gt; |   15| 0.0985709| 1.113742| -1.741084| 2.442707|</span></span>
<span><span class="co">#&gt; |   24| 0.0985709| 1.113742| -1.741084| 2.442707|</span></span>
<span></span>
<span><span class="va">data_long_f_no_missing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/devMSMsHelpers/man/formatLongData.html" class="external-link">formatLongData</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_long</span>, exposure <span class="op">=</span> <span class="va">exposure</span>, </span>
<span>                              exposure_time_pts <span class="op">=</span> <span class="va">exposure_time_pts</span>, outcome <span class="op">=</span> <span class="va">outcome</span>, </span>
<span>                              time_var <span class="op">=</span> <span class="st">"time"</span>, id_var <span class="op">=</span> <span class="st">"S_ID"</span>,                                </span>
<span>                              missing <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                              factor_confounders <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                              home_dir <span class="op">=</span> <span class="va">home_dir</span>, </span>
<span>                              save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Table: Summary of ESETA1 Exposure Information</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; | WAVE|       mean|        sd|       min|      max|</span></span>
<span><span class="co">#&gt; |----:|----------:|---------:|---------:|--------:|</span></span>
<span><span class="co">#&gt; |    6|  0.0155557| 0.8494673| -1.708582| 2.370463|</span></span>
<span><span class="co">#&gt; |   15| -0.2355847| 0.9991753| -2.192502| 1.601213|</span></span>
<span><span class="co">#&gt; |   24| -0.0173328| 1.0256234| -1.906230| 2.328068|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Summary of Outcome StrDif_Tot.58 Information</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; | WAVE|      mean|       sd|       min|      max|</span></span>
<span><span class="co">#&gt; |----:|---------:|--------:|---------:|--------:|</span></span>
<span><span class="co">#&gt; |    6| 0.0985709| 1.113742| -1.741084| 2.442707|</span></span>
<span><span class="co">#&gt; |   15| 0.0985709| 1.113742| -1.741084| 2.442707|</span></span>
<span><span class="co">#&gt; |   24| 0.0985709| 1.113742| -1.741084| 2.442707|</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level4">
<h4 id="p1b--convert-single-long-data-frame-to-wide-format">P1b. Convert single long data frame to wide format<a class="anchor" aria-label="anchor" href="#p1b--convert-single-long-data-frame-to-wide-format"></a>
</h4>
<p>Users with correctly formatted variables in long format have the
option of using the following code to transform their data into wide
format, to proceed to using the package (if there is no missing data) or
imputing (with &lt; 20% missing data MAR).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># v &lt;- sapply(strsplit(tv_confounders[!grepl("\\:", tv_confounders)], "\\."), "[", 1)</span></span>
<span><span class="co"># v &lt;- v[!duplicated(v)]</span></span>
<span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WndNbrhood"</span>, <span class="st">"InRatioCor"</span>, <span class="st">"ESETA1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_wide</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_long_f</span>, </span>
<span>                            idvar <span class="op">=</span> <span class="st">"ID"</span>, <span class="co">#list ID variable in your dataset</span></span>
<span>                            v.names <span class="op">=</span> <span class="va">v</span>, </span>
<span>                            timevar <span class="op">=</span> <span class="st">"WAVE"</span>, <span class="co"># list time variable in your long dataset</span></span>
<span>                            times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">15</span>, <span class="fl">24</span><span class="op">)</span>, <span class="co"># list all time points in your dataset</span></span>
<span>                            direction <span class="op">=</span> <span class="st">"wide"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_wide</span> <span class="op">&lt;-</span> <span class="va">data_wide</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data_wide</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_wide</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Or, we can start with wide data with missingness that is already
formatted.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data_wide &lt;- readRDS("/Users/isabella/Library/CloudStorage/Box-Box/BSL General/MSMs/Tutorial paper/merged_tutorial_filtered.rds" )</span></span>
<span></span>
<span><span class="va">data_wide_missing</span> <span class="op">&lt;-</span> <span class="fu">missMethods</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/missMethods/man/delete_MAR_1_to_x.html" class="external-link">delete_MAR_1_to_x</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">data_wide</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                                                    cols_mis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"InRatioCor.15"</span>, <span class="st">"InRatioCor.24"</span>,</span>
<span>                                                                 <span class="st">"ESETA1.6"</span>, <span class="st">"ESETA1.15"</span>, <span class="st">"ESETA1.24"</span>,</span>
<span>                                                                 <span class="st">"WndNbrhood.6"</span>, <span class="st">"WndNbrhood.15"</span>, <span class="st">"WndNbrhood.24"</span><span class="op">)</span>,</span>
<span>                                                    cols_ctrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"InRatioCor.6"</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span>, <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, if there is no missing data, the user can read in a
formatted, wide dataset ready for use with <em>devMSMs</em>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WndNbrhood"</span>, <span class="st">"InRatioCor"</span>, <span class="st">"ESETA1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_wide_no_missing</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_long_f_no_missing</span>, </span>
<span>                            idvar <span class="op">=</span> <span class="st">"ID"</span>, <span class="co">#list ID variable in your dataset</span></span>
<span>                            v.names <span class="op">=</span> <span class="va">v</span>, </span>
<span>                            timevar <span class="op">=</span> <span class="st">"WAVE"</span>, <span class="co"># list time variable in your long dataset</span></span>
<span>                            times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">15</span>, <span class="fl">24</span><span class="op">)</span>, <span class="co"># list all time points in your dataset</span></span>
<span>                            direction <span class="op">=</span> <span class="st">"wide"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_wide_no_missing</span> <span class="op">&lt;-</span> <span class="va">data_wide</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data_wide</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_wide</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data_wide_no_missing</span></span></code></pre></div>
<p><br></p>
</div>
</div>
<div class="section level3">
<h3 id="p2--impute-data-to-account-for-missingness">P2. Impute Data to Account for Missingness<a class="anchor" aria-label="anchor" href="#p2--impute-data-to-account-for-missingness"></a>
</h3>
<p>The functions of the <em>devMSMs</em> package accept data in the form
of a single data frame with no missing values or m imputed datasets in
the form of either a mids object (output from the mice package or via
<code><a href="https://rdrr.io/pkg/devMSMsHelpers/man/imputeData.html" class="external-link">imputeData()</a></code>) or a list of imputed datasets. Most
developmental data from humans will have some amount of missing data.
Given that the creation of IPTW balancing weights requires complete
data, we recommend imputing data. Imputation assumes a missing data
mechanism of missing at random (MAR) and no more than 20% missing data
in total (Leyrat et al., 2021). Given existing work demonstrating its
superiority, <em>devMSMS</em> implements the ‘within’ approach for
imputed data, conducting all steps on each imputed dataset before
pooling estimates using Rubin’s rules to create final average
predictions and contrast comparisons in <em>Worfklows</em> vignettes
Step 5 (Leyrat et al, 2021; Granger et al., 2019). <br></p>
<div class="section level4">
<h4 id="p2a--multiply-impute-single-wide-formatted-data-frame-using-mice">P2a. Multiply impute single wide, formatted data frame using
mice<a class="anchor" aria-label="anchor" href="#p2a--multiply-impute-single-wide-formatted-data-frame-using-mice"></a>
</h4>
<p>Users have the option of using the helper <code><a href="https://rdrr.io/pkg/devMSMsHelpers/man/imputeData.html" class="external-link">imputeData()</a></code>
function to impute their correctly formatted wide data. This step can
take a while to run. The user can specify how many imputed datasets to
create (default m = 5). <code><a href="https://rdrr.io/pkg/devMSMsHelpers/man/imputeData.html" class="external-link">imputeData()</a></code> draws on the
<code>mice()</code> function from the <em>mice</em> package (van Buuren
&amp; Oudshoorn, 2011) to conduct multiple imputation by chained
equations (mice). All other variables present in the dataset are used to
impute missing data in each column.</p>
<p>The user can specify the imputation method through the
<code>method</code> field drawing from the following list: “pmm”
(predictive mean matching), “midastouch” (weighted predictive mean
matching), “sample” (random sample from observed values), “rf” (random
forest) or “cart” (classification and regression trees). Random forest
imputation is the default given evidence for its efficiency and superior
performance (Shah et al., 2014).</p>
<p>The parameter <code>read_imps_from_file</code> will allow you to read
already imputed data in from local storage (TRUE) so as not to have to
re-run this imputation code multiple times (FALSE; default). Users may
use this parameter to supply their own mids object of imputed data from
the <em>mice</em> package (with the title ‘all_imp.rds’). Be sure to
inspect the console for any warnings as well as the resulting imputed
datasets. Any variables that have missing data following imputation may
need to be removed due to high collinearity and/or low variability.</p>
<p>The required inputs for this function are a data frame in wide format
(formatted according to pre-requirements listed above), m number of
imputed datasets to create, a path to the home directory, (if
<code>save.out = TRUE</code>), exposure (e.g., “variable”), and outcome
(e.g., “variable.t”). The home directory path, exposure, and outcome
should already be defined if the user completed the Specifying Core
Inputs vignette.</p>
<p>Optional inputs are as follows.</p>
<p>The user can specify an imputation method compatible with
<code>mice()</code> (see above). Additionally, the user can specify in
<code>maxit</code> the number of interactions for
<code><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice::mice()</a></code> to conduct (default is 5). The user can also
specify <code>para_proc</code>, a logical indicator indicating whether
or not to speed up imputing using parallel processing (default = TRUE).
This uses 2 cores using functions from the <em>parallel</em>,
<em>doRNG</em>, and <em>doParallel</em> packages.</p>
<p>The user may also specify any additional inputs accepted by
<code><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice::mice()</a></code> and we advise consulting the
<a href:="https://www.rdocumentation.org/packages/mice/versions/3.16.0/topics/mice">[<em>mice</em>
documentation]</a> for more information.<br>
The user can also indicate if they have already created imputed datasets
from this function and wish to read them in
(<code>read_imps_from_file = TRUE</code> rather than recreate them
(default). They can also set <code>save.out = FALSE</code> to suppress
saving intermediate and final output to the local home directory
(recommended and default = TRUE).</p>
<p>For this example, we create 5 imputed datasets using the default
random forest method and 5 iterations and assign the output to
<code>data</code> for use with <em>devMSMs</em>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">5</span> </span>
<span></span>
<span><span class="va">method</span> <span class="op">&lt;-</span> <span class="st">"rf"</span> </span>
<span></span>
<span><span class="va">maxit</span> <span class="op">&lt;-</span> <span class="fl">5</span> </span>
<span></span>
<span><span class="va">imputed_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/devMSMsHelpers/man/imputeData.html" class="external-link">imputeData</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_wide_missing</span>, exposure <span class="op">=</span> <span class="va">exposure</span>, outcome <span class="op">=</span> <span class="va">outcome</span>, </span>
<span>                           m <span class="op">=</span> <span class="va">m</span>, method <span class="op">=</span> <span class="va">method</span>, maxit <span class="op">=</span> <span class="va">maxit</span>, para_proc <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                           read_imps_from_file <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                           home_dir <span class="op">=</span> <span class="va">home_dir</span>, save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Creating 5 imputed datasets using the rf imputation method in mice::mice(). This may take some time to run. </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; USER ALERT: Please view any logged events from the imputation below: </span></span>
<span><span class="co">#&gt; Table: Logged Events from mice::mice</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">imputed_data</span></span></code></pre></div>
<p>We can also read in previously saved imputed data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data &lt;- readRDS("/Users/isabella/Library/CloudStorage/Box-Box/BSL General/MSMs/testing/testing data/continuous outcome/continuous exposure/FLP_wide_imputed_mids.rds") </span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level4">
<h4 id="p2b--read-in-as-a-list-wide-imputed-data-saved-locally">P2b. Read in as a list wide imputed data saved locally<a class="anchor" aria-label="anchor" href="#p2b--read-in-as-a-list-wide-imputed-data-saved-locally"></a>
</h4>
<p>Users can also read in, as a list, imputed data created using a
different function and saved locally as .csv files (labeled “1”:m) in a
single folder.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># folder &lt;- "/Users/isabella/Library/CloudStorage/Box-Box/BSL General/MSMs/testing/testing data/continuous outcome/continuous exposure/imputations/" </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># files &lt;- list.files(folder, full.names = TRUE, pattern = "\\.csv") #make sure pattern matches suffix of your data</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># data &lt;- lapply(files, function(file) {</span></span>
<span><span class="co">#   imp_data &lt;- read.csv(file)</span></span>
<span><span class="co">#   imp_data</span></span>
<span><span class="co"># })</span></span></code></pre></div>
<p><br></p>
</div>
</div>
<div class="section level3">
<h3 id="p3--optional-identify-exposure-epochs">P3. Optional: Identify Exposure Epochs<a class="anchor" aria-label="anchor" href="#p3--optional-identify-exposure-epochs"></a>
</h3>
<p>Users have the option to specify exposure epochs as input to the
<code><a href="../reference/fitModel.html">fitModel()</a></code> and <code><a href="../reference/compareHistories.html">compareHistories()</a></code>
<em>devMSMs</em> functions (see <em>Workflows</em> vignettes). The
specification of exposure epochs should be kept consistent throughout
these preliminary steps and in the two above functions. The exposure
time points specified in the core inputs section constitute the time
points at which IPTW weights will be created and assessed. Unless the
user specifies separate exposure epochs, those time points will also
constitute the main effects variables when modeling the relation between
exposure and outcome (<em>Workflows</em> vignettes Step 5a) and form the
basis for estimating and comparing exposure histories
(<em>Workflows</em> vignettes Step 5b). The user has the option to draw
on theory and the structure of their data to specify developmental
epochs of exposure that differ from the time points at which exposure
was collected.</p>
<p>To specify epochs, users utilize the optional <code>epochs</code>
argument by providing a data frame that contains two variables: for
epochs: provide, in quotations, a list of user-created names for each
epoch; for values: as a list, for each named epoch, provide a single
integer or a list of integers (from the exposure time points) that
constitute each epoch. Each named epoch must have a corresponding value
(but the values for each epoch can differ in their number of entries, as
shown below). The user should ensure that all epoch values are included
in the <code>exposure_time_pts</code> field (see above).</p>
<p>Any specified epochs will be applied in the final modeling step of
the MSM process when exposure levels will be averaged across values
(<em>Workflows</em> vignettes Step 5). If no epochs are specified, the
time points at which exposure was measured will be used in Step 5 of the
<em>Workflows</em> vignettes.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">epochs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>epochs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Infancy"</span>, <span class="co">#list user-specified names</span></span>
<span>                                <span class="st">"Toddlerhood"</span>, </span>
<span>                                <span class="st">"Childhood"</span><span class="op">)</span>, </span>
<span>                     values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>, <span class="co">#list corresponding time points from data</span></span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span>, </span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span><span class="op">)</span></span>
<span>                     <span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="p4--recommended-specify-inspect-exposure-histories">P4. Recommended: Specify &amp; Inspect Exposure Histories<a class="anchor" aria-label="anchor" href="#p4--recommended-specify-inspect-exposure-histories"></a>
</h3>
<p>Exposure histories are the units by which users will test their
substantive hypotheses and their construction should be determined by
both theoretical and practical reasoning. We strongly recommend users
verify and inspect exposure histories a priori in relation to their data
and hypotheses.<br><br></p>
</div>
<div class="section level3">
<h3 id="p4a--create-high-and-low-cutoff-values-for-continuous-exposures">P4a. Create high and low cutoff values for continuous exposures<a class="anchor" aria-label="anchor" href="#p4a--create-high-and-low-cutoff-values-for-continuous-exposures"></a>
</h3>
<p>First, for continuously distributed exposures (regardless of whether
or not exposure epochs are specified), we recommend users indicate high
and low cutoff values as an optional input to the
<code><a href="../reference/compareHistories.html">compareHistories()</a></code>) <em>devMSMs</em> function (see
<em>Workflows</em> vignettes). To do so, they specify to
<code>hi_lo_cut</code>, as a list, a quantile value (0-1) above which
will be considered high levels exposure, followed by a quantile value
(0-1) below which will be considered low levels of exposure (default is
median split). These values may have to be revised following inspection
of the sample distribution across the resulting exposure histories in
the subsequent steps. These final values should be used in creating
exposure histories in Step 5 of the <em>Workflows</em> vignettes.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hi_lo_cut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.3</span><span class="op">)</span> <span class="co">#empirical example </span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="p4b--specify-hypotheses-relevant-exposure-histories">P4b. Specify hypotheses-relevant exposure histories<a class="anchor" aria-label="anchor" href="#p4b--specify-hypotheses-relevant-exposure-histories"></a>
</h3>
<p>We strongly recommend all users be selective about which histories,
or developmental sequences of high and low exposure (at exposure time
points or epochs), are vital for testing their hypotheses. The units of
the exposure histories are the exposure time points if no epochs are
specified. We recommend that the user estimates and compares only a
subset of all possible exposure histories (i.e., sequences of high and
low levels of exposure at each epoch or time point) using the
<code>reference</code> and <code>comparison</code> fields (rather than
comparing all possible exposure histories).</p>
<p>The user can specify a custom subset of user-specified exposure
histories (i.e., sequences of high and low levels of exposure at each
epoch or time point) using the <code>reference</code> and
<code>comparison</code> fields as optional inputs to the
<code><a href="../reference/compareHistories.html">compareHistories()</a></code> <em>devMSMs</em> function (see
<em>Workflows</em> vignettes). To conduct these customized comparisons,
users must provide at least one unique valid history (e.g., “l-l-l”) as
a reference by, in quotations, provide a string (or a list of strings)
of lowercase l’s and h’s (each separated by -), each corresponding to
each exposure epoch (or time point), that signify the sequence of
exposure levels (“low” or “high”, respectively).</p>
<p>If you supply a reference history, in comparisons provide at least
one unique and valid history for comparison by, in quotations, providing
a string (or list of strings) of l’s and h’s (each separated by “-”),
with each corresponding to each exposure epoch, that signify the
sequence of exposure levels (“low” or “high”, respectively) that
constitutes the comparison exposure history/histories to be compared to
the reference. If you supply one or more comparisons, at least one
reference must be specified. Each reference exposure history will be
compared to each comparison history and all comparisons will be supplied
for multiple comparison correction. If no reference or comparison is
specified, all histories will be compared to each other.</p>
<p>These final reference and comparison values established at this step
should be used for estimating and comparing exposure histories in Step
5b of the <em>Workflows</em> vignettes. If there are more than 4
exposure main effects (either as epochs or exposure time points), the
user is required to select a subset of history comparisons (Step 5b of
the <em>Workflows</em> vignettes), given that the base code (see the
<code>hypotheses()</code> function from the <em>marginaleffects</em>
package) cannot accommodate all pairwise history comparisons for more
than 5 time points).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reference</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"l-l-l"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"h-h-h"</span>, <span class="st">"h-l-l"</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="p4c--inspect-exposure-histories-and-data">P4c. Inspect exposure histories and data<a class="anchor" aria-label="anchor" href="#p4c--inspect-exposure-histories-and-data"></a>
</h3>
<p>For all users, we highly recommend use of the helper
<code><a href="https://rdrr.io/pkg/devMSMsHelpers/man/inspectData.html" class="external-link">inspectData()</a></code> function (with the original dataset long or
wide format or imputed data in the case of missingness) to summarize
exposure, outcome, and confounders and inspect the sample distribution
among exposure histories. Based on any user-specified exposure epochs
and high and low quantile values (for continuous exposures), this
function outputs a table showing the sample distribution across all
histories.</p>
<p>We strongly suggest visually inspecting this table and revising the
designation of epochs and/or high and low quantile values (for
continuous exposures) until each history contains a reasonable number of
participants. While there is no gold standard required number per
history cell, users should guard against extrapolation beyond the scope
of the data. For example, in our data, when using 75th and 25th
percentile cutoffs, there were histories that represented less than two
cases and thus we re-evaluated our cutoffs. Users may wish to revise any
epoch designation and high and low cutoff values, where applicable. The
function conducts summaries and history distribution inspection for each
imputed dataset if imputed data are supplied. <br></p>
<p><em>insert Table 2</em></p>
<p><br></p>
<p>The required inputs for <code><a href="https://rdrr.io/pkg/devMSMsHelpers/man/inspectData.html" class="external-link">inspectData()</a></code> are: data (as a
data frame in wide or long format, a list of imputed data frames in wide
format, or a mids object), a path to the home directory, exposure (e.g.,
“variable”), and outcome (e.g., “variable.t”).</p>
<p>Optional inputs are time-varying confounders (e.g., “variable.t”),
epochs, high/low cutoff values for continuous exposures, and
specification of reference and comparison histories (see above). The
specification of exposure epochs should be kept consistent throughout
the use of the <em>devMSMs</em> package (see <em>Workflows</em>
vignettes). The home directory path, exposure, exposure time points,
confounders, and outcome should already be defined if the user completed
the
<a href="https://istallworthy.github.io/devMSMs/articles/Specify_Core_Inputs.html">Specifying
Core Inputs vignette</a>.</p>
<p>The helper <code><a href="https://rdrr.io/pkg/devMSMsHelpers/man/inspectData.html" class="external-link">inspectData()</a></code> function outputs the following
files into the home directory: a correlation plot of all variables in
the dataset, tables of exposure and outcome descriptive statistics, and
two summary tables of the confounders considered at each time point.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/devMSMsHelpers/man/inspectData.html" class="external-link">inspectData</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, exposure <span class="op">=</span> <span class="va">exposure</span>, exposure_time_pts <span class="op">=</span> <span class="va">exposure_time_pts</span>, outcome <span class="op">=</span> <span class="va">outcome</span>, <span class="co"># required input</span></span>
<span>            ti_confounders <span class="op">=</span> <span class="va">ti_confounders</span>, tv_confounders <span class="op">=</span> <span class="va">tv_confounders</span>, <span class="co"># required input</span></span>
<span>            epochs <span class="op">=</span> <span class="va">epochs</span>, hi_lo_cut <span class="op">=</span> <span class="va">hi_lo_cut</span>, reference <span class="op">=</span> <span class="va">reference</span>, comparison <span class="op">=</span> <span class="va">comparison</span>, <span class="co">#optional input</span></span>
<span>            home_dir <span class="op">=</span> <span class="va">home_dir</span>, verbose <span class="op">=</span> <span class="va">verbose</span>, save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span> <span class="co">#optional input</span></span>
<span><span class="co">#&gt; Using github PAT from envvar GITHUB_PAT</span></span>
<span><span class="co">#&gt; Skipping install of 'devMSMs' from a github remote, the SHA1 (ba059176) has not changed since last install.</span></span>
<span><span class="co">#&gt;   Use `force = TRUE` to force installation</span></span>
<span><span class="co">#&gt; Imputation 1</span></span>
<span><span class="co">#&gt; Summary of Exposure Main Effects: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; USER ALERT: Out of the total of 50 individuals in the sample, below is the distribution of the 5 (10%) individuals that fall into 3 out of the 3 the total user-defined exposure histories created from 30th and 60th percentile values for low and high levels of exposure ESETA1, respectively, across Infancy, Toddlerhood, Childhood. </span></span>
<span><span class="co">#&gt; USER ALERT: Please inspect the distribution of the sample across the following exposure histories and ensure there is sufficient spread to avoid extrapolation and low precision: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Summary of user-specified exposure ESETA1 histories based on exposure main effects Infancy, Toddlerhood, Childhood containing time points 6, 15, 24:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |history |  n|</span></span>
<span><span class="co">#&gt; |:-------|--:|</span></span>
<span><span class="co">#&gt; |h-h-h   |  3|</span></span>
<span><span class="co">#&gt; |h-l-l   |  1|</span></span>
<span><span class="co">#&gt; |l-l-l   |  1|</span></span>
<span><span class="co">#&gt; Imputation 2</span></span>
<span><span class="co">#&gt; Summary of Exposure Main Effects: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; USER ALERT: Out of the total of 50 individuals in the sample, below is the distribution of the 10 (20%) individuals that fall into 3 out of the 3 the total user-defined exposure histories created from 30th and 60th percentile values for low and high levels of exposure ESETA1, respectively, across Infancy, Toddlerhood, Childhood. </span></span>
<span><span class="co">#&gt; USER ALERT: Please inspect the distribution of the sample across the following exposure histories and ensure there is sufficient spread to avoid extrapolation and low precision: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Summary of user-specified exposure ESETA1 histories based on exposure main effects Infancy, Toddlerhood, Childhood containing time points 6, 15, 24:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |history |  n|</span></span>
<span><span class="co">#&gt; |:-------|--:|</span></span>
<span><span class="co">#&gt; |h-h-h   |  5|</span></span>
<span><span class="co">#&gt; |h-l-l   |  3|</span></span>
<span><span class="co">#&gt; |l-l-l   |  2|</span></span>
<span><span class="co">#&gt; Imputation 3</span></span>
<span><span class="co">#&gt; Summary of Exposure Main Effects: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; USER ALERT: Out of the total of 50 individuals in the sample, below is the distribution of the 8 (16%) individuals that fall into 3 out of the 3 the total user-defined exposure histories created from 30th and 60th percentile values for low and high levels of exposure ESETA1, respectively, across Infancy, Toddlerhood, Childhood. </span></span>
<span><span class="co">#&gt; USER ALERT: Please inspect the distribution of the sample across the following exposure histories and ensure there is sufficient spread to avoid extrapolation and low precision: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Summary of user-specified exposure ESETA1 histories based on exposure main effects Infancy, Toddlerhood, Childhood containing time points 6, 15, 24:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |history |  n|</span></span>
<span><span class="co">#&gt; |:-------|--:|</span></span>
<span><span class="co">#&gt; |h-h-h   |  6|</span></span>
<span><span class="co">#&gt; |h-l-l   |  1|</span></span>
<span><span class="co">#&gt; |l-l-l   |  1|</span></span>
<span><span class="co">#&gt; Imputation 4</span></span>
<span><span class="co">#&gt; Summary of Exposure Main Effects: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; USER ALERT: Out of the total of 50 individuals in the sample, below is the distribution of the 10 (20%) individuals that fall into 3 out of the 3 the total user-defined exposure histories created from 30th and 60th percentile values for low and high levels of exposure ESETA1, respectively, across Infancy, Toddlerhood, Childhood. </span></span>
<span><span class="co">#&gt; USER ALERT: Please inspect the distribution of the sample across the following exposure histories and ensure there is sufficient spread to avoid extrapolation and low precision: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Summary of user-specified exposure ESETA1 histories based on exposure main effects Infancy, Toddlerhood, Childhood containing time points 6, 15, 24:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |history |  n|</span></span>
<span><span class="co">#&gt; |:-------|--:|</span></span>
<span><span class="co">#&gt; |h-h-h   |  5|</span></span>
<span><span class="co">#&gt; |h-l-l   |  3|</span></span>
<span><span class="co">#&gt; |l-l-l   |  2|</span></span>
<span><span class="co">#&gt; Imputation 5</span></span>
<span><span class="co">#&gt; Summary of Exposure Main Effects: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; USER ALERT: Out of the total of 50 individuals in the sample, below is the distribution of the 6 (12%) individuals that fall into 3 out of the 3 the total user-defined exposure histories created from 30th and 60th percentile values for low and high levels of exposure ESETA1, respectively, across Infancy, Toddlerhood, Childhood. </span></span>
<span><span class="co">#&gt; USER ALERT: Please inspect the distribution of the sample across the following exposure histories and ensure there is sufficient spread to avoid extrapolation and low precision: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Summary of user-specified exposure ESETA1 histories based on exposure main effects Infancy, Toddlerhood, Childhood containing time points 6, 15, 24:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |history |  n|</span></span>
<span><span class="co">#&gt; |:-------|--:|</span></span>
<span><span class="co">#&gt; |h-h-h   |  3|</span></span>
<span><span class="co">#&gt; |h-l-l   |  2|</span></span>
<span><span class="co">#&gt; |l-l-l   |  1|</span></span>
<span><span class="co">#&gt; The following inspection is conducted on the first imputed dataset.</span></span>
<span><span class="co">#&gt; USER ALERT: Below are the 11 variables spanning 5 unique domains that will be treated as confounding variables for the relation between ESETA1 and StrDif_Tot.58.</span></span>
<span><span class="co">#&gt; Please inspect this list carefully. It should include all time-varying covariates, time invariant covariates, as well as lagged levels of exposure and outcome variables if they were collected at time points earlier than the outcome time point.</span></span>
<span><span class="co">#&gt;  [1] "ESETA1.15"     "ESETA1.24"     "ESETA1.6"      "gov_assist"   </span></span>
<span><span class="co">#&gt;  [5] "InRatioCor.15" "InRatioCor.24" "InRatioCor.6"  "peri_health"  </span></span>
<span><span class="co">#&gt;  [9] "WndNbrhood.15" "WndNbrhood.24" "WndNbrhood.6" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following variables are designated as numeric: </span></span>
<span><span class="co">#&gt; [1] "ID, peri_health, gov_assist, StrDif_Tot.58, WndNbrhood.6, InRatioCor.6, ESETA1.6, WndNbrhood.15, InRatioCor.15, ESETA1.15, WndNbrhood.24, InRatioCor.24, ESETA1.24"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following variables are designated as factors: </span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary of Exposure Main Effects: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; USER ALERT: Out of the total of 50 individuals in the sample, below is the distribution of the 5 (10%) individuals that fall into 3 out of the 3 the total user-defined exposure histories created from 30th and 60th percentile values for low and high levels of exposure ESETA1, respectively, across Infancy, Toddlerhood, Childhood. </span></span>
<span><span class="co">#&gt; USER ALERT: Please inspect the distribution of the sample across the following exposure histories and ensure there is sufficient spread to avoid extrapolation and low precision: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Summary of user-specified exposure ESETA1 histories based on exposure main effects Infancy, Toddlerhood, Childhood containing time points 6, 15, 24:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |history |  n|</span></span>
<span><span class="co">#&gt; |:-------|--:|</span></span>
<span><span class="co">#&gt; |h-h-h   |  3|</span></span>
<span><span class="co">#&gt; |h-l-l   |  1|</span></span>
<span><span class="co">#&gt; |l-l-l   |  1|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Your outcome variable(s) have the following type(s): numeric</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Arel-Bundock, Vincent. 2023. marginaleffects: Predictions,
Comparisons, Slopes, Marginal Means, and Hypothesis Tests. <a href="https://CRAN.R-project.org/package=marginaleffects" class="external-link uri">https://CRAN.R-project.org/package=marginaleffects</a>.</p>
<p>Granger, E., Sergeant, J. C., &amp; Lunt, M. (2019). Avoiding
pitfalls when combining multiple imputation and propensity scores.
Statistics in Medicine, 38(26), 5120–5132. <a href="https://doi.org/10.1002/sim.8355" class="external-link uri">https://doi.org/10.1002/sim.8355</a></p>
<p>Leyrat, C., Carpenter, J. R., Bailly, S., &amp; Williamson, E. J.
(2021). Common Methods for Handling Missing Data in Marginal Structural
Models: What Works and Why. American Journal of Epidemiology, 190(4),
663–672. <a href="https://doi.org/10.1093/aje/kwaa225" class="external-link uri">https://doi.org/10.1093/aje/kwaa225</a></p>
<p>Shah, A. D., Bartlett, J. W., Carpenter, J., Nicholas, O., &amp;
Hemingway, H. (2014). Comparison of Random Forest and Parametric
Imputation Models for Imputing Missing Data Using MICE: A CALIBER Study.
American Journal of Epidemiology, 179(6), 764–774. <a href="https://doi.org/10.1093/aje/kwt312" class="external-link uri">https://doi.org/10.1093/aje/kwt312</a></p>
<p>van Buuren, Stef, and Karin Groothuis-Oudshoorn. 2011. “mice:
Multivariate Imputation by Chained Equations in r.” Journal of
Statistical Software 45 (3): 1–67. <a href="https://doi.org/10.18637/jss.v045.i03" class="external-link uri">https://doi.org/10.18637/jss.v045.i03</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Isabella Stallworthy, Noah Greifer, Meriah DeJoseph, Emily Padrutt, Daniel Berry.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
