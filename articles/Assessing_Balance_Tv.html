<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="devMSMs">
<title>Assessing Balance for Time-Varying Exposures â€¢ devMSMs</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Assessing Balance for Time-Varying Exposures">
<meta property="og:description" content="devMSMs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">devMSMs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Dev.html">Dev</a>
    <a class="dropdown-item" href="../articles/Terminology.html">Terminology</a>
    <a class="dropdown-item" href="../articles/Data_Requirements.html">Data Requirements &amp; Preparation</a>
    <a class="dropdown-item" href="../articles/Specify_Core_Inputs.html">Specify Core Inputs</a>
    <a class="dropdown-item" href="../articles/Workflow_Continuous_Exposure.html">Workflow: Continuous Exposure</a>
    <a class="dropdown-item" href="../articles/Customize_Balancing_Formulas.html">Customize Balancing Formulas</a>
    <a class="dropdown-item" href="../articles/Assessing_Balance_Tv.html">Assessing Balance for Time-Varying Exposures</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/istallworthy/devMSMs/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Assessing Balance for Time-Varying Exposures</h1>
            
            <h4 data-toc-skip class="date">2024-07-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/istallworthy/devMSMs/blob/HEAD/vignettes/Assessing_Balance_Tv.qmd" class="external-link"><code>vignettes/Assessing_Balance_Tv.qmd</code></a></small>
      <div class="d-none name"><code>Assessing_Balance_Tv.qmd</code></div>
    </div>

    
    
<p>Asessing balance for time-varying exposures is a topic that has not
been extensively examined in the MSM literature. However, Jackson (2016)
has established guidance that we draw on for this package, implemented
in the <code>calcBalStats()</code> function (drawn on by the
<code><a href="../reference/assessBalance.html">assessBalance()</a></code> function) in <em>devMSMs</em>.</p>
<div class="section level2">
<h2 id="calculating-raw-balance-statistics">Calculating Raw Balance Statistics<a class="anchor" aria-label="anchor" href="#calculating-raw-balance-statistics"></a>
</h2>
<p><code>calcBalStats()</code> assesses balance using correlations
between confounder and exposure for continuous exposures and
standardized mean differences of the confounder between exposure groups
for binary exposures. These balancing statistics are created based on
the diagnostics for confounding of time-varying exposures outlined by
Jackson (2016). More specifically, at each user-specified exposure time
point, raw balance statistics are calculated to quantify the association
between exposure at that time point and each confounder, for each
exposure history up until that time point. This is accomplished using
the <code>col_w_cov()</code> function to calculate covariance for
continuous exposures and the <code>col_w_smd()</code> function to
calculate mean difference for binary exposures from the <em>cobalt</em>
package (Greifer, 2023). Factor covariates are split into separate dummy
variables using the <code>splitfactor()</code> function from cobalt. Any
covariate interactions present in the formulas are created in the data
by multiplying the constituent variables, with interactions including
factor covariates implemented by constituent dummy variables.</p>
</div>
<div class="section level2">
<h2 id="weighting-balance-statistics-by-exposure-history">Weighting Balance Statistics By Exposure History<a class="anchor" aria-label="anchor" href="#weighting-balance-statistics-by-exposure-history"></a>
</h2>
<p>In the <code>calcBalStats()</code> function, exposure histories
comprise all combinations of the presence and absence of exposure
(delineated using a median split for continuous exposures) at all prior
time points (note that these may be different from the user-specified,
substantive exposure histories used to compare dose and timing in the
final model; Step 5). Subsequently, a weighted mean of the balance
statistics, weighted by the proportion of individuals in that exposure
history, provides a raw estimate of balance between exposure at that
time point for each confounder. On the occasion that there are balancing
statistics for only one person or no people in a given exposure history,
the user is alerted and that balance statistic is dropped from
inclusion. These raw (unstandardized) balance statistics are calculated
without IPTW weights for pre-balance checking and using the IPTW
balancing weights (that have been multiplied across time points) for
weighted analyses.</p>
</div>
<div class="section level2">
<h2 id="standardizing-balance-statistics">Standardizing Balance Statistics<a class="anchor" aria-label="anchor" href="#standardizing-balance-statistics"></a>
</h2>
<p>For the purpose of comparison to each other and to a common balance
threshold, balancing statistics are then similarly standardized in the
following manner. For continuous exposures, the raw balance statistic
(covariance) is divided by the product of the standard deviation of the
unweighted confounder and the standard deviation of the exposure at that
time point to calculate the correlation. Given this, it is possible that
the correlation may be greater than 1.</p>
<p>For binary exposures, the raw balance statistic (mean difference) is
divided by a pooled standard deviation estimate, or the square root of
the average of the standard deviations of the unweighted confounder
levels for the exposed and unexposed groups at the first exposure time
point. All standard deviations are computed using the unadjusted sample
(as recommended by Stuart, 2008; 2010; Greifer, 2022) given the
possibility that balancing changes the variation in a confounder and
leads to misleading standardized values. At the first exposure time
point (when there are no histories), standardized balance statistics are
computed directly using the same cobalt functions mentioned above.</p>
</div>
<div class="section level2">
<h2 id="imputed-data">Imputed Data<a class="anchor" aria-label="anchor" href="#imputed-data"></a>
</h2>
<p>If imputed data are supplied, the above process is conducted on each
imputed dataset separately. The function then takes the average of the
absolute values of the balance statistics across imputed datasets to
account for sampling error (Pishgar et al., 2021 preprint). These
averaged average balance statistics are then compared to the balance
threshold(s) to summarize which covariates are balanced. Recommended
specification of separate balance thresholds for relatively more and
less important confounders can be found in the <em>Workflows</em>
vignettes. The specification of balance threshold(s) should be kept
consistent throughout the use of the <em>devMSMs</em> package.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Greifer, N. (2022). cobalt: Covariate Balance Tables and Plots
(4.4.1) <span class="math display">\[Computer software\]</span>. <a href="https://CRAN.R-project.org/package=cobalt" class="external-link uri">https://CRAN.R-project.org/package=cobalt</a></p>
<p>Jackson, J. W. (2016). Diagnostics for Confounding of Time-varying
and Other Joint Exposures. Epidemiology, 27(6), 859. <a href="https://doi.org/10.1097/EDE.0000000000000547" class="external-link uri">https://doi.org/10.1097/EDE.0000000000000547</a></p>
<p>Pishgar, F., Greifer, N., Leyrat, C., &amp; Stuart, E. (2021).
MatchThem: Matching andWeighting after Multiple Imputation. R Journal,
13(2), 292â€“305. <a href="https://doi.org/10.32614/RJ-2021-073" class="external-link uri">https://doi.org/10.32614/RJ-2021-073</a></p>
<p>Stuart, E. A. (2008). Developing practical recommendations for the
use of propensity scores: Discussion of â€˜A critical appraisal of
propensity score matching in the medical literature between 1996 and
2003â€™ by Peter Austin, Statistics in Medicine. Statistics in Medicine,
27(12), 2062â€“2065. <a href="https://doi.org/10.1002/sim.3207" class="external-link uri">https://doi.org/10.1002/sim.3207</a></p>
<p>Stuart, E. A. (2010). Matching methods for causal inference: A review
and a look forward. Statistical Scienceâ€¯: A Review Journal of the
Institute of Mathematical Statistics, 25(1), 1â€“21. <a href="https://doi.org/10.1214/09-STS313" class="external-link uri">https://doi.org/10.1214/09-STS313</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isabella Stallworthy, Noah Greifer, Meriah DeJoseph, Emily Padrutt, Daniel Berry.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
