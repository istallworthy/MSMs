{"title":"Assessing Balance for Time-Varying Exposures","markdown":{"yaml":{"title":"Assessing Balance for Time-Varying Exposures","date":"today","format":{"html":{"df_print":"kable","toc":true}},"vignette":"%\\VignetteIndexEntry{Assessing_Balance_Tv} %\\VignetteEncoding{UTF-8}s %\\VignetteEngine{quarto::html}\n"},"headingText":"Calculating Raw Balance Statistics","containsRefs":false,"markdown":"\n\nAssessing balance for time-varying exposures is a topic that has not been extensively examined in the MSM literature. However, Jackson (2016) has established guidance that we draw on for this package, implemented in the `calcBalStats()` function (drawn on by the `assessBalance()` function) in *devMSMs*.\n\n\n`calcBalStats()` assesses balance using correlations between confounder and exposure for continuous exposures and standardized mean differences of the confounder between exposure groups for binary exposures. These balancing statistics are created based on the diagnostics for confounding of time-varying exposures outlined by Jackson (2016). More specifically, at each user-specified exposure time point, raw balance statistics are calculated to quantify the association between exposure at that time point and each confounder, for each exposure history up until that time point. This is accomplished using the `col_w_cov()` function to calculate covariance for continuous exposures and the `col_w_smd()` function to calculate mean difference for binary exposures from the *cobalt* package (Greifer, 2023). Factor covariates are split into separate dummy variables using the `splitfactor()` function from cobalt. Any covariate interactions present in the formulas are created in the data by multiplying the constituent variables, with interactions including factor covariates implemented by constituent dummy variables.\n\n## Weighting Balance Statistics By Exposure History\n\nIn the `calcBalStats()` function, exposure histories comprise all combinations of the presence and absence of exposure (delineated using a median split for continuous exposures) at all prior time points (note that these may be different from the user-specified, substantive exposure histories used to compare dose and timing in the final model; Step 5). Subsequently, a weighted mean of the balance statistics, weighted by the proportion of individuals in that exposure history, provides a raw estimate of balance between exposure at that time point for each confounder. On the occasion that there are balancing statistics for only one person or no people in a given exposure history, the user is alerted and that balance statistic is dropped from inclusion. These raw (unstandardized) balance statistics are calculated without IPTW weights for pre-balance checking and using the IPTW balancing weights (that have been multiplied across time points) for weighted analyses.\n\n## Standardizing Balance Statistics\n\nFor the purpose of comparison to each other and to a common balance threshold, balancing statistics are then similarly standardized in the following manner. For continuous exposures, the raw balance statistic (covariance) is divided by the product of the standard deviation of the unweighted confounder and the standard deviation of the exposure at that time point to calculate the correlation. Given this, it is possible that the correlation may be greater than 1.\n\nFor binary exposures, the raw balance statistic (mean difference) is divided by a pooled standard deviation estimate, or the square root of the average of the standard deviations of the unweighted confounder levels for the exposed and unexposed groups at the first exposure time point. All standard deviations are computed using the unadjusted sample (as recommended by Stuart, 2008; 2010; Greifer, 2022) given the possibility that balancing changes the variation in a confounder and leads to misleading standardized values. At the first exposure time point (when there are no histories), standardized balance statistics are computed directly using the same cobalt functions mentioned above.\n\n## Imputed Data\n\nIf imputed data are supplied, the above process is conducted on each imputed dataset separately. The function then takes the average of the absolute values of the balance statistics across imputed datasets to account for sampling error (Pishgar et al., 2021 preprint). These averaged average balance statistics are then compared to the balance threshold(s) to summarize which covariates are balanced. Recommended specification of separate balance thresholds for relatively more and less important confounders can be found in the *Workflows* vignettes. The specification of balance threshold(s) should be kept consistent throughout the use of the *devMSMs* package.\n\n## References\n\nGreifer, N. (2022). cobalt: Covariate Balance Tables and Plots (4.4.1) \\[Computer software\\]. https://CRAN.R-project.org/package=cobalt\n\nJackson, J. W. (2016). Diagnostics for Confounding of Time-varying and Other Joint Exposures. Epidemiology, 27(6), 859. https://doi.org/10.1097/EDE.0000000000000547\n\nPishgar, F., Greifer, N., Leyrat, C., & Stuart, E. (2021). MatchThem: Matching andWeighting after Multiple Imputation. R Journal, 13(2), 292–305. https://doi.org/10.32614/RJ-2021-073\n\nStuart, E. A. (2008). Developing practical recommendations for the use of propensity scores: Discussion of ‘A critical appraisal of propensity score matching in the medical literature between 1996 and 2003’ by Peter Austin, Statistics in Medicine. Statistics in Medicine, 27(12), 2062–2065. https://doi.org/10.1002/sim.3207\n\nStuart, E. A. (2010). Matching methods for causal inference: A review and a look forward. Statistical Science : A Review Journal of the Institute of Mathematical Statistics, 25(1), 1–21. https://doi.org/10.1214/09-STS313\n","srcMarkdownNoYaml":"\n\nAssessing balance for time-varying exposures is a topic that has not been extensively examined in the MSM literature. However, Jackson (2016) has established guidance that we draw on for this package, implemented in the `calcBalStats()` function (drawn on by the `assessBalance()` function) in *devMSMs*.\n\n## Calculating Raw Balance Statistics\n\n`calcBalStats()` assesses balance using correlations between confounder and exposure for continuous exposures and standardized mean differences of the confounder between exposure groups for binary exposures. These balancing statistics are created based on the diagnostics for confounding of time-varying exposures outlined by Jackson (2016). More specifically, at each user-specified exposure time point, raw balance statistics are calculated to quantify the association between exposure at that time point and each confounder, for each exposure history up until that time point. This is accomplished using the `col_w_cov()` function to calculate covariance for continuous exposures and the `col_w_smd()` function to calculate mean difference for binary exposures from the *cobalt* package (Greifer, 2023). Factor covariates are split into separate dummy variables using the `splitfactor()` function from cobalt. Any covariate interactions present in the formulas are created in the data by multiplying the constituent variables, with interactions including factor covariates implemented by constituent dummy variables.\n\n## Weighting Balance Statistics By Exposure History\n\nIn the `calcBalStats()` function, exposure histories comprise all combinations of the presence and absence of exposure (delineated using a median split for continuous exposures) at all prior time points (note that these may be different from the user-specified, substantive exposure histories used to compare dose and timing in the final model; Step 5). Subsequently, a weighted mean of the balance statistics, weighted by the proportion of individuals in that exposure history, provides a raw estimate of balance between exposure at that time point for each confounder. On the occasion that there are balancing statistics for only one person or no people in a given exposure history, the user is alerted and that balance statistic is dropped from inclusion. These raw (unstandardized) balance statistics are calculated without IPTW weights for pre-balance checking and using the IPTW balancing weights (that have been multiplied across time points) for weighted analyses.\n\n## Standardizing Balance Statistics\n\nFor the purpose of comparison to each other and to a common balance threshold, balancing statistics are then similarly standardized in the following manner. For continuous exposures, the raw balance statistic (covariance) is divided by the product of the standard deviation of the unweighted confounder and the standard deviation of the exposure at that time point to calculate the correlation. Given this, it is possible that the correlation may be greater than 1.\n\nFor binary exposures, the raw balance statistic (mean difference) is divided by a pooled standard deviation estimate, or the square root of the average of the standard deviations of the unweighted confounder levels for the exposed and unexposed groups at the first exposure time point. All standard deviations are computed using the unadjusted sample (as recommended by Stuart, 2008; 2010; Greifer, 2022) given the possibility that balancing changes the variation in a confounder and leads to misleading standardized values. At the first exposure time point (when there are no histories), standardized balance statistics are computed directly using the same cobalt functions mentioned above.\n\n## Imputed Data\n\nIf imputed data are supplied, the above process is conducted on each imputed dataset separately. The function then takes the average of the absolute values of the balance statistics across imputed datasets to account for sampling error (Pishgar et al., 2021 preprint). These averaged average balance statistics are then compared to the balance threshold(s) to summarize which covariates are balanced. Recommended specification of separate balance thresholds for relatively more and less important confounders can be found in the *Workflows* vignettes. The specification of balance threshold(s) should be kept consistent throughout the use of the *devMSMs* package.\n\n## References\n\nGreifer, N. (2022). cobalt: Covariate Balance Tables and Plots (4.4.1) \\[Computer software\\]. https://CRAN.R-project.org/package=cobalt\n\nJackson, J. W. (2016). Diagnostics for Confounding of Time-varying and Other Joint Exposures. Epidemiology, 27(6), 859. https://doi.org/10.1097/EDE.0000000000000547\n\nPishgar, F., Greifer, N., Leyrat, C., & Stuart, E. (2021). MatchThem: Matching andWeighting after Multiple Imputation. R Journal, 13(2), 292–305. https://doi.org/10.32614/RJ-2021-073\n\nStuart, E. A. (2008). Developing practical recommendations for the use of propensity scores: Discussion of ‘A critical appraisal of propensity score matching in the medical literature between 1996 and 2003’ by Peter Austin, Statistics in Medicine. Statistics in Medicine, 27(12), 2062–2065. https://doi.org/10.1002/sim.3207\n\nStuart, E. A. (2010). Matching methods for causal inference: A review and a look forward. Statistical Science : A Review Journal of the Institute of Mathematical Statistics, 25(1), 1–21. https://doi.org/10.1214/09-STS313\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"Assessing_Balance_Tv.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","about":{"template":"trestles"},"navbar":{"right":[{"text":"Search","href":"#"},{"text":"GitHub","href":"https://github.com/istallworthy/devMSMs"}],"left":[{"text":"../Vignettes","href":"Assessing_Balance_Tv.qmd"}]},"title":"Assessing Balance for Time-Varying Exposures","date":"today","vignette":"%\\VignetteIndexEntry{Assessing_Balance_Tv} %\\VignetteEncoding{UTF-8}s %\\VignetteEngine{quarto::html}\n","df_print":"kable"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}